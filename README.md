# XLS批量转换工具 📊

一个基于Streamlit的强大Excel文件批量转换工具，支持将XLS、XLSX文件批量转换为CSV、PDF、XLSX格式。

## ✨ 主要功能

- 📊 **多格式支持**: 支持XLS、XLSX输入格式
- 🔄 **批量转换**: 一次处理多个文件
- 📝 **多种输出**: 支持CSV、PDF、XLSX输出格式
- 🎯 **灵活配置**: 工作表级别的转换控制
- 📁 **便捷下载**: 一键下载ZIP打包结果
- 🖥️ **友好界面**: 现代化的Web界面
- 📋 **数据预览**: 上传前预览文件内容

## 🚀 快速开始

### 环境要求

- Python 3.8+
- pip包管理器

### 安装依赖

```bash
pip install -r requirements.txt
```

### 运行应用

```bash
streamlit run app.py
```

应用将在浏览器中自动打开，默认地址：`http://localhost:8501`

## 📖 使用说明

### 1. 上传文件
- 点击"选择Excel文件进行转换"或拖拽文件到上传区域
- 支持同时上传多个文件（最多10个）
- 单个文件大小限制：50MB

### 2. 预览数据
- 可选择预览上传文件的内容
- 支持多工作表文件的工作表选择
- 显示基本统计信息（行数、列数、空值数）

### 3. 配置转换
- **输出格式**: 选择CSV、PDF或XLSX
- **CSV选项**: 配置编码和分隔符
- **PDF选项**: 设置页面大小和方向
- **工作表处理**: 选择转换所有工作表或特定工作表

### 4. 执行转换
- 点击"开始批量转换"按钮
- 实时显示转换进度
- 查看转换结果统计

### 5. 下载结果
- 自动生成ZIP打包文件
- 一键下载所有转换后的文件

## 🔧 配置选项

### CSV输出配置
- **编码**: UTF-8、GBK、ISO-8859-1
- **分隔符**: 逗号、分号、制表符、竖线

### PDF输出配置
- **页面大小**: A4、A3、Letter
- **页面方向**: 纵向、横向
- **自动分页**: 支持大数据表格分页

### 工作表处理
- **所有工作表**: 转换文件中的所有工作表
- **仅第一个工作表**: 只转换第一个工作表
- **选择特定工作表**: 为每个文件单独选择工作表

## 📁 项目结构

```
xlsxx/
├── app.py                      # 主应用入口
├── requirements.txt           # 依赖包列表
├── config/
│   └── settings.py           # 配置文件
├── core/
│   ├── converter.py          # 核心转换逻辑
│   ├── file_handler.py       # 文件处理逻辑
│   └── utils.py             # 工具函数
├── ui/
│   ├── main_interface.py     # 主界面组件
│   ├── upload_section.py     # 文件上传组件
│   └── download_section.py   # 文件下载组件
├── temp/                     # 临时文件目录
└── README.md
```

## 🔒 安全特性

- **临时文件管理**: 自动清理24小时前的临时文件
- **文件名清理**: 自动处理非法字符
- **大小限制**: 严格控制上传文件大小
- **格式验证**: 验证文件格式和完整性

## ⚠️ 使用限制

- 单个文件最大：50MB
- 批量处理最多：10个文件
- 临时文件保留：24小时
- PDF输出最大行数：100行（避免文件过大）

## 🛠️ 技术栈

- **前端框架**: Streamlit
- **数据处理**: Pandas、OpenPyXL
- **PDF生成**: ReportLab
- **文件处理**: Python标准库

## 📝 更新日志

### v1.0.0
- 🎉 初始版本发布
- ✅ 支持XLS/XLSX到CSV/PDF/XLSX转换
- ✅ 批量处理功能
- ✅ Web界面
- ✅ 文件预览功能

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个项目！

## 📄 许可证

本项目采用MIT许可证。

## 📞 支持

如果您在使用过程中遇到问题，请：

1. 检查文件格式是否受支持
2. 确认文件大小在限制范围内
3. 查看错误信息并按提示操作
4. 尝试重置应用状态

---

**享受批量转换的便利！** 🚀 